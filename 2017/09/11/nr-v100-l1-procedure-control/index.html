<!-- build time:Tue Oct 24 2017 08:56:21 GMT+0800 (中国标准时间) --><!DOCTYPE html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-center-simple.min.css?v=1.0.2" rel="stylesheet"><script></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=PingFang SC:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css"><meta name="keywords" content="2017-09,5G-NR,3GPP,"><link rel="alternate" href="/atom.xml" title="Marshall" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2"><meta name="description" content="同步过程小区搜索小区搜索过程是UE获得和小区时间和频率同步，并检测物理层小区ID的过程。为进行小区搜索，UE需接收下列同步信号：主同步信号（PSS）和辅同步信号（SSS）。主辅同步信号在TS 38.211中定义。UE应假设PBCH、PSS和SSS在连续的OFDM符号内接收，并且形成SS/PBCH块。对于半帧中的SS/PBCH块，候选SS/PBCH块的OFDM 符号索引号和第1个OFDM符号索引根据"><meta property="og:type" content="article"><meta property="og:title" content="5G-NR物理层过程（控制）v1.0.0"><meta property="og:url" content="http://marshallcomm.cn/2017/09/11/nr-v100-l1-procedure-control/index.html"><meta property="og:site_name" content="Marshall"><meta property="og:description" content="同步过程小区搜索小区搜索过程是UE获得和小区时间和频率同步，并检测物理层小区ID的过程。为进行小区搜索，UE需接收下列同步信号：主同步信号（PSS）和辅同步信号（SSS）。主辅同步信号在TS 38.211中定义。UE应假设PBCH、PSS和SSS在连续的OFDM符号内接收，并且形成SS/PBCH块。对于半帧中的SS/PBCH块，候选SS/PBCH块的OFDM 符号索引号和第1个OFDM符号索引根据"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/095958597.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/100046252.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/100136656.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/100506146.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/100635180.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/101231694.png"><meta property="og:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/101316284.png"><meta property="og:updated_time" content="2017-10-24T00:55:33.268Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="5G-NR物理层过程（控制）v1.0.0"><meta name="twitter:description" content="同步过程小区搜索小区搜索过程是UE获得和小区时间和频率同步，并检测物理层小区ID的过程。为进行小区搜索，UE需接收下列同步信号：主同步信号（PSS）和辅同步信号（SSS）。主辅同步信号在TS 38.211中定义。UE应假设PBCH、PSS和SSS在连续的OFDM符号内接收，并且形成SS/PBCH块。对于半帧中的SS/PBCH块，候选SS/PBCH块的OFDM 符号索引号和第1个OFDM符号索引根据"><meta name="twitter:image" content="http://olyzl8414.bkt.clouddn.com/blog/20170912/095958597.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",sidebar:{position:"left",display:"post",offset:12,offset_float:12,b2t:!0,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://marshallcomm.cn/2017/09/11/nr-v100-l1-procedure-control/"><title>5G-NR物理层过程（控制）v1.0.0 | Marshall</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Marshall</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Comm. Tech. Blog</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://marshallcomm.cn/2017/09/11/nr-v100-l1-procedure-control/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Marshall"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Marshall"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">5G-NR物理层过程（控制）v1.0.0</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-11T09:43:15+08:00">2017-09-11 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/5G-NR/" itemprop="url" rel="index"><span itemprop="name">5G-NR</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/09/11/nr-v100-l1-procedure-control/#SOHUCS" itemprop="discussionUrl"><span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2017/09/11/nr-v100-l1-procedure-control/" itemprop="commentsCount"></span> </a><span class="post-meta-divider">|</span> <span class="page-pv"><i class="fa fa-file-o"></i> <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="同步过程"><a href="#同步过程" class="headerlink" title="同步过程"></a>同步过程</h1><h2 id="小区搜索"><a href="#小区搜索" class="headerlink" title="小区搜索"></a>小区搜索</h2><p><br>小区搜索过程是UE获得和小区时间和频率同步，并检测物理层小区ID的过程。</p><p>为进行小区搜索，UE需接收下列同步信号：主同步信号（PSS）和辅同步信号（SSS）。主辅同步信号在TS 38.211中定义。</p><p>UE应假设PBCH、PSS和SSS在连续的OFDM符号内接收，并且形成SS/PBCH块。</p><p>对于半帧中的SS/PBCH块，候选SS/PBCH块的OFDM 符号索引号和第1个OFDM符号索引根据下列情况确定：</p><ul><li>15 KHz子载波间隔：候选SS/PBCH块的第1个OFDM符号有索引{2, 8} + 14*n。对于载波频率小于等于3 GHz，有n=0, 1。对于载波频率大于3 GHz且小于6 GHz，有n=0, 1, 2, 3。</li><li>30 KHz子载波间隔：候选SS/PBCH块的第1个OFDM符号有索引{4, 8, 16, 20} + 28*n。对于载波频率小于等于3 GHz，有n=0。对于载波频率大于3 GHz且小于6 GHz，有n=0, 1。</li><li>30 KHz子载波间隔：候选SS/PBCH块的第1个OFDM符号有索引{2, 8} + 14*n。对于载波频率小于等于3 GHz，有n=0, 1。对于载波频率大于3 GHz且小于6 GHz，有n=0, 1, 2, 3。</li><li>120 KHz子载波间隔：候选SS/PBCH块的第1个OFDM符号有索引{4, 8, 16, 20} + 28*n。对于载波频率大于6 GHz，有n=0, 1, 2, 3, 5, 6, 7, 8, 10, 11, 12, 13, 15, 16, 17, 18。</li><li>240 KHz子载波间隔：候选SS/PBCH块的第1个OFDM符号有索引{8, 12, 16, 20, 32, 36, 40, 44} + 56*n。对于载波频率大于6 GHz，有n=0, 1, 2, 3, 5, 6, 7, 8。</li></ul><p>一个半帧中的候选SS/PBCH块在时域上以升序从0到$ L-1 ]$进行编号。对于$ L=4 $或$ L&gt;4 $，UE应根据与每个半帧内SS/PBCH块索引一一对应的PBCH中传输的DM-RS序列索引，分别确定SS/PBCH块索引的2或3个LSB比特。对于$ L=64 $，UE应根据高层参数[<em>SSB-index-explicit</em>]确定每个半帧内SS/PBCH块索引的3 个MSB比特。</p><a id="more"></a><blockquote><p>注：DM-RS序列索引在TS 38.211中定义。</p></blockquote><p>UE可通过参数[<em>SSB-transmitted-SIB1</em>]被配置，SS/PBCH块索引对于与SS/PBCH块对应重叠的REs，UE不应接收其他信号或信道。UE也可通过高层参数[<em>SSB-transmitted</em>]在每个服务小区被配置，SS/PBCH块索引对于与SS/PBCH块对应重叠的REs，UE不应接收其他信号或信道。[通过[<em>SSB-transmitted</em>]配置优先于通过[<em>SSB-transmitted-SIB1</em>]配置。]</p><blockquote><p>注：May be removed and captured in 38.211。</p></blockquote><p>对于每个服务小区中SS/PBCH块的接收，UE可以在每个服务小区通过高层参数[<em>SSB-timing</em>]每半帧周期性地被配置。如果对于SS/PBCH块的接收，UE没有每半帧被周期性配置，则UE应假设以半帧为周期。UE应假设在服务小区中，对于所有SS/PBCH块，周期是相同的。</p><p>对于初始小区的选择，UE可以假设SS/PBCH块半帧出现的周期为2帧。</p><h2 id="传输定时调整"><a href="#传输定时调整" class="headerlink" title="传输定时调整"></a>传输定时调整</h2><h2 id="Timing-for-secondary-cell-activation-deactivation"><a href="#Timing-for-secondary-cell-activation-deactivation" class="headerlink" title="Timing for secondary cell activation / deactivation"></a>Timing for secondary cell activation / deactivation</h2><h1 id="无线链路监测"><a href="#无线链路监测" class="headerlink" title="无线链路监测"></a>无线链路监测</h1><p><br>为了向高层指示失步/同时状态，UE应监测主小区的下行无线链路质量。</p><p>此处暂省略300+字，具体内容详见原文档。</p><h1 id="链路重配置过程"><a href="#链路重配置过程" class="headerlink" title="[链路重配置过程]"></a>[链路重配置过程]</h1><p><br>在一个服务小区内为了[RSRP x 或SINR]测量，UE可以配置一组CSI-RS资源或一组SS/PBCH块索引。UE应假设SCI-RS采用非零传输功率。每个CSI-RS资源参数通过高层信令配置，这些参数包括：</p><ul><li>[资源配置]</li><li>[周期]</li><li>[天线端口]</li><li>[传输功率]</li><li>[伪随机序列生成参数]</li><li>[QCL参数]</li><li>[…]</li></ul><blockquote><p>[Editor’s note: For reconfiguration request, there are also no existing agreements to describe preamble retransmissions, or the window for the UE to receive a response, or the configuration of the CORESET where the PDCCH scheduling the response is transmitted, etc.]</p></blockquote><h1 id="上行功率控制"><a href="#上行功率控制" class="headerlink" title="上行功率控制"></a>上行功率控制</h1><h2 id="物理上行共享信道"><a href="#物理上行共享信道" class="headerlink" title="物理上行共享信道"></a>物理上行共享信道</h2><h3 id="UE-behaviour"><a href="#UE-behaviour" class="headerlink" title="UE behaviour"></a>UE behaviour</h3><h3 id="Power-headroom"><a href="#Power-headroom" class="headerlink" title="Power headroom"></a>Power headroom</h3><h2 id="物理上行控制信道"><a href="#物理上行控制信道" class="headerlink" title="物理上行控制信道"></a>物理上行控制信道</h2><h3 id="UE-behaviour-1"><a href="#UE-behaviour-1" class="headerlink" title="UE behaviour"></a>UE behaviour</h3><h2 id="探测参考信号"><a href="#探测参考信号" class="headerlink" title="探测参考信号"></a>探测参考信号</h2><h2 id="物理随机接入信道"><a href="#物理随机接入信道" class="headerlink" title="物理随机接入信道"></a>物理随机接入信道</h2><p><br>在时隙$ i $内，对于服务小区$c$，UE通过下式确定PRACH传输功率：</p><p><script type="math/tex">{ {P}_{\text{PRACH,c}}}(i)=\min { {\left\{ { {P}_{\text{CMAX},c}}(i),\ { {P}_{\text{PRACH,target}}}+P{ {L}_{c}} \right\}}^{ {}}}</script>dBm</p><p>其中$ { {P}_{\text{CMAX,c}}}(i) $是在TS 38.133中定义的服务小区$c$中在时隙$i$的UE传输功率，$ { {P}_{\text{PRACH,target}}} $由高层参数[<em>preambleReceivedTargetPower</em>]提供，$ P{ {L}_{c}} $是UE计算对于服务小区$c$的路径损耗，单位为dB。为了确定$ { {P}_{\text{PRACH,c}}}(i) $，UE计算路径损耗$ P{ {L}_{c}} $。路径损耗根据SS/PBCH块得到，即$ P{ {L}_{c}} $ = <em>SS/PBCHBlockPower</em> – higher layer filtered RSRP，其中<em>SS/PBCHBlockPower</em>由[<em>SystemInformationBlockType1</em>]提供，RSRP在TS 38.215中定义，高层滤波器配置在TS 38.331中定义。</p><p>如果一个随机接入响应窗口内，如5.2小节中描述，UE不接收随机接入响应，随机接入响应包含了一个与UE发送的前导序列对应的前导ID，UE将为随后的PRACH传输确定传输功率，如果有的话。[TS 38.321]</p><h2 id="载波聚合"><a href="#载波聚合" class="headerlink" title="载波聚合"></a>载波聚合</h2><h2 id="双连接"><a href="#双连接" class="headerlink" title="双连接"></a>双连接</h2><h1 id="随机接入过程"><a href="#随机接入过程" class="headerlink" title="随机接入过程"></a>随机接入过程</h1><p><br>在进行初始化的物理随机接入过程之前，L1应该从高层接收一组SS/PBCH块索引，并且应向高层提供一组对应的RSRP测量。</p><p>在进行初始化的物理随机接入过程之前，L1应该从高层接收以下信息：</p><ul><li>PRACH传输参数（PRACH前导格式，用于PRACH传输的时域和频域资源）</li><li>用于决定小区中根序列及其在前导序列集合中的循环移位值的参数（逻辑根序列表格索引、循环移位$ N_{\text{CS}}^{ {}} $、集合类型（受限集合和非受限集合））</li></ul><p>从物理层来看，物理层随机接入过程包括PRACH中随机接入前导（Msg1）的发送，PDSCH（Msg2）中的随机接入响应（RAR），PUSCH中的Msg3和PDSCH中的Msg4。</p><blockquote><p>批注：Tentatively, Msg3 and Msg4 will be described as part of the RA procedure due to various differences from PUSCH/PDSCH after RRC connection.</p></blockquote><h2 id="随机接入前导"><a href="#随机接入前导" class="headerlink" title="随机接入前导"></a>随机接入前导</h2><p><br>L1过程通过PRACH传输请求被触发，PRACH传输由高层来配置。高层对PRACH传输的配置包括：</p><ul><li>对于PRACH传输，高层参数[<em>PRACH-config</em>]提供的配置</li><li>对于PRACH传输，高层参数[<em>PRACH-cell-idx</em>]提供的服务小区索引</li><li>前导索引，PRACH格式，$ { {P}_{\text{PRACH,target}}} $，相应的RA-RNTI，PRACH资源</li><li>[对于PRACH传输的重复次数，也作为请求的一部分由高层指示]</li></ul><p>A PRACH format is selected from the preamble sequence set for the corresponding preamble sequence length using the preamble index.</p><p>在所指示的PRACH资源上，前导使用所选择的PRACH格式发送，传输功率为4.4节描述的$ { {P}_{\text{PRACH}}} $。</p><h3 id="定时"><a href="#定时" class="headerlink" title="定时"></a>定时</h3><h2 id="随机接入响应"><a href="#随机接入响应" class="headerlink" title="随机接入响应"></a>随机接入响应</h2><p><br>UE通过高层[TS 38.321]在一个约束窗内，采用所指示的RA-RNTI尝试检测PDCCH。窗口开始于最早的CORESET的符号。对于Type1-PDCCH公共搜索空间，UE配置了CORESET。Type1-PDCCH公共搜索空间在7.1节进行了定义，在前导序列传输的[X]个符号之后。随机接入响应窗口的长度由高层参数[<em>rar-windowlength</em>]提供。</p><p>如果UE在时间窗内，采用所指示的RA-RNTI和相应的DL-SCH传输块检测PDCCH，UE将传输块传递到高层。高层分析传输块并向物理层指示上行授权。如果在时间窗内，UE不检测PDCCH或相应的DL-SCH传输块，则UE过程如[TS 38.321]中的描述。</p><p>如果UE在时间窗内，采用所指示的RA-RNTI和相应的DL-SCH传输块检测PDCCH，高层指示[XX]比特的上行授权到物理层。这一过程被称为物理层的随机接入响应（RAR）。UE应接收PDCCH和PDSCH。作为包含[<em>SystemInformationBlockType1</em>]的PDSCH的接收，PDSCH包含了具有相同子载波间隔和相同CP的DL-SCH传输块。[XX]比特的内容，开始于MSB，结束于LSB：</p><p>[…]</p><blockquote><p>批注：To be completed as the contents of the UL grant in the RAR are determined.</p></blockquote><h2 id="Msg3-PUSCH"><a href="#Msg3-PUSCH" class="headerlink" title="Msg3 PUSCH"></a>Msg3 PUSCH</h2><p><br>对于Msg3 PUSCH传输，高层参数[<em>msg3-tp</em>]指示UE是否应用变换预编码（transform precoding），变换预编在[TS 38.211]中描述。</p><p>Msg3 PUSCH传输的子载波间隔由高层参数[<em>msg3-scs</em>]提供。</p><p>UE应在相同的服务小区内发送PRACH和Msg3 PUSCH。</p><h2 id="Msg4-PDSCH"><a href="#Msg4-PDSCH" class="headerlink" title="Msg4 PDSCH"></a>Msg4 PDSCH</h2><p><br>Msg4 PDSCH传输的子载波间隔与PDSCH相同提供随机接入响应。</p><h1 id="UE-procedure-for-reporting-control-information"><a href="#UE-procedure-for-reporting-control-information" class="headerlink" title="UE procedure for reporting control information"></a>UE procedure for reporting control information</h1><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/095958597.png" alt="mark"></p><h2 id="UE-procedure-for-HARQ-ACK-codebook-determination"><a href="#UE-procedure-for-HARQ-ACK-codebook-determination" class="headerlink" title="UE procedure for HARQ-ACK codebook determination"></a>UE procedure for HARQ-ACK codebook determination</h2><h3 id="CBG-based-HARQ-ACK-codebook-determination"><a href="#CBG-based-HARQ-ACK-codebook-determination" class="headerlink" title="CBG-based HARQ-ACK codebook determination"></a>CBG-based HARQ-ACK codebook determination</h3><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/100046252.png" alt="mark"></p><blockquote><p>批注：[HARQ-ACK information bits] The actual number of bits to report can be different – e.g. with bundling.</p><p>批注：[initial] For retransmissions, decisions are needed for dynamic/semi-static HARQ-ACK codebook determination and for possible DCI indications.</p><p>批注：[a] No decision currently exists for 2 TBs (e.g. same number for both TBs, separately configured number per TB).</p></blockquote><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/100136656.png" alt="mark"></p><blockquote><p>批注：[the UE determines whether or not a CBG is retransmitted based on a corresponding value of the CBGTI field] Placeholder text – will be modified once the specifics for the operation of the CBGTI field are decided.</p><p>批注：[<em>cc</em>] LTE terminology for indicating semi-static codebook (can be modified once RRC terminology is finalized). Statement in brackets will be removed if only semi-static codebook determination is supported for CBG-based HARQ-ACK.</p></blockquote><h2 id="UE-procedure-for-reporting-HARQ-ACK"><a href="#UE-procedure-for-reporting-HARQ-ACK" class="headerlink" title="UE procedure for reporting HARQ-ACK"></a>UE procedure for reporting HARQ-ACK</h2><h3 id="HARQ-ACK-reporting-in-physical-uplink-shared-channel"><a href="#HARQ-ACK-reporting-in-physical-uplink-shared-channel" class="headerlink" title="HARQ-ACK reporting in physical uplink shared channel"></a>HARQ-ACK reporting in physical uplink shared channel</h3><h3 id="HARQ-ACK-reporting-in-physical-uplink-control-channel"><a href="#HARQ-ACK-reporting-in-physical-uplink-control-channel" class="headerlink" title="HARQ-ACK reporting in physical uplink control channel"></a>HARQ-ACK reporting in physical uplink control channel</h3><p><br>如果UE没有配置为PUSCH和PUCCH同时传输，并且UE不传输PUSCH，且不传输CSI或positive/negative SR，则UE应传输HARQ-ACK</p><ul><li>on PUCCH format 0 if<ul><li>the transmission is over 1 symbol or 2 symbols,</li><li>the number of HARQ-ACK information bits is 1 or 2</li></ul></li><li>on PUCCH format 1 if<ul><li>the transmission is over 4 or more symbols,</li><li>the number of HARQ-ACK information bits is 1 or 2</li></ul></li><li>on PUCCH format 2 if<ul><li>the transmission is over 1 symbol or 2 symbols,</li><li>the number of HARQ-ACK information bits is more than 2</li></ul></li><li>on PUCCH format 3 if<ul><li>the transmission is over 4 or more symbols,</li><li>the number of HARQ-ACK information bits is more than [2]</li></ul></li></ul><p>UE在一个时隙的$ N_{\text{symb}}^{\text{slot},\mu } $个符号上发送一个或多个PUCCH。对于PUCCH传输时隙的参考，如果UE在PDCCH上检测DCI格式，其中PDCCH通过一定数量的符号调度PDSCH的接收，这些符号的最后一个符号在时隙$n$内，则UE应在PUCCH传输中提供相应的HARQ-ACK信息，PUCCH在时隙$ n+k $上传输，其中$k$是时隙数，且通过DCI格式中的[DL-data-DL-acknowledgement]字段来指示。[DL-data-DL-acknowledgement]字段的值映射到时隙数的值，见Table 9.1.2-1中的定义。</p><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/100506146.png" alt="mark"></p><blockquote><p>批注：Dynamic indication of symbols within a slot or joint indication of time/frequency/code PUCCH resources is not precluded pending specific RAN1 agreements.</p></blockquote><h4 id="HARQ-ACK-procedures-for-one-configured-serving-cell"><a href="#HARQ-ACK-procedures-for-one-configured-serving-cell" class="headerlink" title="HARQ-ACK procedures for one configured serving cell"></a>HARQ-ACK procedures for one configured serving cell</h4><h4 id="HARQ-ACK-procedures-for-more-than-one-configured-serving-cell"><a href="#HARQ-ACK-procedures-for-more-than-one-configured-serving-cell" class="headerlink" title="HARQ-ACK procedures for more than one configured serving cell"></a>HARQ-ACK procedures for more than one configured serving cell</h4><h2 id="UE-procedure-for-reporting-SR"><a href="#UE-procedure-for-reporting-SR" class="headerlink" title="UE procedure for reporting SR"></a>UE procedure for reporting SR</h2><blockquote><p>批注：There are currently no RAN1 decisions on SR transmission structure and possible multiplexing with HARQ-ACK/CSI</p></blockquote><h2 id="UE-procedure-for-reporting-multiple-UCI-types"><a href="#UE-procedure-for-reporting-multiple-UCI-types" class="headerlink" title="UE procedure for reporting multiple UCI types"></a>UE procedure for reporting multiple UCI types</h2><h2 id="UCI-repetition-procedure"><a href="#UCI-repetition-procedure" class="headerlink" title="UCI repetition procedure"></a>UCI repetition procedure</h2><h1 id="UE-procedure-for-receiving-control-information"><a href="#UE-procedure-for-receiving-control-information" class="headerlink" title="UE procedure for receiving control information"></a>UE procedure for receiving control information</h1><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/100635180.png" alt="mark"></p><p>UE应在一个或多个激活的服务小区或BWPs上，根据相应的搜索空间，在一个或多个CORESET内监听一组PDCCH候选集，其中搜索空间是根据所监听的DCI格式译码每个PDCCH候选。</p><blockquote><p>批注：[PDCCH候选集] Can add more details later, such as per activated cell, etc., based on respective agreements.</p><p>批注：[DCI formats] Can remain applicable for potentially mapping multiple DCI formats to a same size (as for LTE DCI format 0 and DCI format 1A).</p></blockquote><h2 id="UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-common-search-space"><a href="#UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-common-search-space" class="headerlink" title="UE procedure for determining physical downlink control channel assignment in common search space"></a>UE procedure for determining physical downlink control channel assignment in common search space</h2><p><br>UE应在下列一个或多个搜索空间内监听PDCCH候选：</p><ul><li>a Type0-PDCCH common search space for a DCI format scrambled by a [SI-RNTI] on a primary cell</li><li>a Type1-PDCCH common search space for a DCI format scrambled by a [RA-RNTI] on a primary cell</li><li>a Type2-PDCCH common search space for a DCI format scrambled by a [INT-RNTI]</li></ul><p>[UE应在没有载波指示域的情况下监听PDCCH候选。]</p><p>如果UE通过高层配置为以[INT-RNTI]加扰的CRC译码DCI格式，UE也在[每个服务小区]配置[一组]PRBs和一组OFDM符号。如果UE以[INT-RNTI]加扰的CRC检测DCI格式，UE可以假设不在这组PRBs和OFDM符号中发送。UE通过高层参数[<em>int-PRBs-unit</em>]配置PRBs的指示粒度。UE通过高层参数[<em>int-symbols-unit</em>]配置OFDM符号的指示粒度。UE通过高层参数[<em>Num-PDCCH-cand</em>]来配置对于DCI格式的每个CCE聚合等级下的若干PDCCH候选，其中DCI格式使用[INT-RNTI]加扰的CRC。</p><blockquote><p>批注：[[INT-RNTI]加扰的CRC] Eventually, this DCI format will have a name and will be used to remove this part.</p></blockquote><h2 id="UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-UE-specific-search-space"><a href="#UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-UE-specific-search-space" class="headerlink" title="UE procedure for determining physical downlink control channel assignment in UE-specific search space"></a>UE procedure for determining physical downlink control channel assignment in UE-specific search space</h2><p><br>对于每个服务小区，高层信令给UE配置$ Q $个CORESETs。对于CORESET $q$，$ 0\le q&lt;Q $，配置包括：</p><ul><li>高层参数[<em>CORESET-start-symb</em>]提供第1个OFDM符号</li><li>高层参数[<em>CORESET-time-duration</em>]提供若干连续的OFDM符号</li><li>高层参数[<em>CORESET-freq-dom</em>]提供一组RBs集合</li><li>高层参数[<em>CORESET-trans-type</em>]提供CCE-to-REG映射</li><li>对于交织的CCE-to-REG映射，高层参数[<em>CORESET-REG-bundle-size</em>]提供REG bundle大小</li><li>[高层参数[<em>CORESET-QCL-ConfigId</em>]提供天线端口quasi-collocation]</li></ul><p>对于非交织的CCE-to-REG映射，REG bundle大小等于6。UE可以假设一个REG bundle内的所有REGs上传输的PDCCH应用相同的预编码。</p><blockquote><p>批注：[对于非交织的CCE-to-REG映射，REG bundle大小等于6。] Can be updated if additional REG bundle sizes are defined for non-interleaved transmissions.</p></blockquote><p>每个CORESET包含一组从0到$ { {N}_{\text{CCE},q}}-1 $编号的CCEs，其中$ { {N}_{\text{CCE},q}} $是CORESET $q$中的CCEs个数。</p><p>UE所监听的PDCCH候选集定义在PDCCH UE特定搜索空间。PDCCH UE特定搜索空间在聚合等级$ L\in \left\{ 1, 2, 4, 8 \right\} $上定义为，对于CCE聚合等级$L$的一组PDCCH候选。对于一个DCI格式，UE在每个服务小区内通过高层参数[<em>Num-PDCCH-cand</em>]配置每个CCE聚合等级 下的一组PDCCH候选。</p><blockquote><p>批注：[UE特定搜索空间] Cross-carrier scheduling, including use of different numerologies, will be captured through the search space.</p></blockquote><p>对于连续接收（non-DRX）模式操作，UE在根据$ { {W}_{\text{PDCCH,} q}} $个符号周期，监听CORESET $q$中的PDCCH候选，其中对于CORESET $q$的$ { {W}_{\text{PDCCH,} q}} $由高层参数[<em>CORESET-monitor-period</em>]配置。</p><blockquote><p>批注：[CORESET-monitor-period] Need to determine how, based on configured periodicity, UE monitors PDCCH and whether it is a CORESET or a search space parameter. Allowed periodicity values (symbol, slot, etc.) are TBD (start from 1 symbol) and are to be included in RAN2 specifications (likely not visible in 38.213).</p></blockquote><p>服务小区中的UE，在UE特定的搜索空间监听PDCCH的候选，如果UE没有配置载波指示域，UE应在没有载波指示域的条件下监听PDCCH候选。服务小区中的UE，在UE 特定的搜索空间监听PDCCH的候选，如果UE配置了载波指示域，则UE应使用载波指示域监听PDCCH候选。</p><p>如果UE在另一个服务小区上被配置使用对应于secondary cell的载波指示来监听PDCCH候选，UE不希望在secondary cell上监听PDCCH候选。[对于服务小区中的UE监听PDCCH候选，UE应至少在同一个服务小区内监听PDCCH候选。]</p><h1 id="Bandwidth-part-operation"><a href="#Bandwidth-part-operation" class="headerlink" title="Bandwidth part operation"></a>Bandwidth part operation</h1><blockquote><p>批注：It will be attempted, as much as possible, to capture all BWP operation aspects in this Subclause while referring to other Subclauses. Potential overlaps will be resolved as the specifications progress.</p><p>批注：Text is subject to revisions as descriptions in 38.211 and 38.213 are aligned.</p></blockquote><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/101231694.png" alt="mark"></p><blockquote><p>批注：[BWP] Regarding the CSS, he agreement for its configuration is ambiguous. Which CSS configuration is it (e.g. is it for SIB scheduling, for GC-PDCCH, … )? Maybe multiple CSS configurations are applicable as in Subclause 10.1? Reference to primary cell in the agreement points to SIB scheduling but clarification is needed for what the CSS intends to do, whether the respective BWP is same as the BWP from initial access, ….</p></blockquote><p><img src="http://olyzl8414.bkt.clouddn.com/blog/20170912/101316284.png" alt="mark"></p><blockquote><p>批注：[transmissions] Activation/deactivation by DCI requires further details (e.g. it is FFS whether it is a DCI scheduling PDSCH/PUSCH in a configured BWP ot a separate DCI). Deactivation by a timer also requires further details (e.g. no separate specifications if it is the DRX timer). A separate timer may be described in RRC specifications as for the DRX timer.</p></blockquote><h1 id="Configurations-and-assumptions-independent-of-physical-channels-or-signals"><a href="#Configurations-and-assumptions-independent-of-physical-channels-or-signals" class="headerlink" title="Configurations and assumptions independent of physical channels or signals"></a>Configurations and assumptions independent of physical channels or signals</h1><blockquote><p>批注：[signals] To capture reserved resources, potential LTE-NR coexistence aspects, etc. For LTE-NR DC with single UL Tx, corresponding agreement regarding configuration of DL-reference UL/DL configuration affects only LTE operation, is suitable for LTE specifications, and is not captured (unless it is extended to NR-NR DC).</p></blockquote><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><p><br><a href="http://marshallcomm.cn/2017/09/08/nr-v100-general-description/">NR物理层概述</a><br><a href="http://marshallcomm.cn/2017/09/08/nr-v100-l1-service/">NR物理层提供的服务</a><br><a href="http://marshallcomm.cn/2017/09/09/nr-v100-l1-channel-modulation/">NR物理信道与调制</a><br><a href="http://marshallcomm.cn/2017/09/10/nr-v100-l1-multiplexing-coding/">NR复用与信道编码</a></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/2017-09/" rel="tag"><i class="fa fa-tag"></i> 2017-09</a> <a href="/tags/5G-NR/" rel="tag"><i class="fa fa-tag"></i> 5G-NR</a> <a href="/tags/3GPP/" rel="tag"><i class="fa fa-tag"></i> 3GPP</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/09/10/nr-v100-l1-multiplexing-coding/" rel="next" title="5G-NR复用与信道编码v1.0.0"><i class="fa fa-chevron-left"></i> 5G-NR复用与信道编码v1.0.0</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/09/11/nr-v100-l1-index/" rel="prev" title="5G-NR物理层协议v1.0.0">5G-NR物理层协议v1.0.0 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_tqq"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_cqq"></a> <a class="jiathis_button_douban"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_kaixin001"></a> <a class="jiathis_button_copy"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script></div></div></div><div class="comments" id="comments"><div id="SOHUCS" sid="1505094195000"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Marshall"><p class="site-author-name" itemprop="name">Marshall</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">37</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">6</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:marshallcomm@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#同步过程"><span class="nav-number">1.</span> <span class="nav-text">同步过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#小区搜索"><span class="nav-number">1.1.</span> <span class="nav-text">小区搜索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#传输定时调整"><span class="nav-number">1.2.</span> <span class="nav-text">传输定时调整</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Timing-for-secondary-cell-activation-deactivation"><span class="nav-number">1.3.</span> <span class="nav-text">Timing for secondary cell activation / deactivation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#无线链路监测"><span class="nav-number">2.</span> <span class="nav-text">无线链路监测</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#链路重配置过程"><span class="nav-number">3.</span> <span class="nav-text">[链路重配置过程]</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#上行功率控制"><span class="nav-number">4.</span> <span class="nav-text">上行功率控制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#物理上行共享信道"><span class="nav-number">4.1.</span> <span class="nav-text">物理上行共享信道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-behaviour"><span class="nav-number">4.1.1.</span> <span class="nav-text">UE behaviour</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Power-headroom"><span class="nav-number">4.1.2.</span> <span class="nav-text">Power headroom</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#物理上行控制信道"><span class="nav-number">4.2.</span> <span class="nav-text">物理上行控制信道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-behaviour-1"><span class="nav-number">4.2.1.</span> <span class="nav-text">UE behaviour</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#探测参考信号"><span class="nav-number">4.3.</span> <span class="nav-text">探测参考信号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#物理随机接入信道"><span class="nav-number">4.4.</span> <span class="nav-text">物理随机接入信道</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#载波聚合"><span class="nav-number">4.5.</span> <span class="nav-text">载波聚合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#双连接"><span class="nav-number">4.6.</span> <span class="nav-text">双连接</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#随机接入过程"><span class="nav-number">5.</span> <span class="nav-text">随机接入过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#随机接入前导"><span class="nav-number">5.1.</span> <span class="nav-text">随机接入前导</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#定时"><span class="nav-number">5.1.1.</span> <span class="nav-text">定时</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#随机接入响应"><span class="nav-number">5.2.</span> <span class="nav-text">随机接入响应</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Msg3-PUSCH"><span class="nav-number">5.3.</span> <span class="nav-text">Msg3 PUSCH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Msg4-PDSCH"><span class="nav-number">5.4.</span> <span class="nav-text">Msg4 PDSCH</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UE-procedure-for-reporting-control-information"><span class="nav-number">6.</span> <span class="nav-text">UE procedure for reporting control information</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-HARQ-ACK-codebook-determination"><span class="nav-number">6.1.</span> <span class="nav-text">UE procedure for HARQ-ACK codebook determination</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CBG-based-HARQ-ACK-codebook-determination"><span class="nav-number">6.1.1.</span> <span class="nav-text">CBG-based HARQ-ACK codebook determination</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-reporting-HARQ-ACK"><span class="nav-number">6.2.</span> <span class="nav-text">UE procedure for reporting HARQ-ACK</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HARQ-ACK-reporting-in-physical-uplink-shared-channel"><span class="nav-number">6.2.1.</span> <span class="nav-text">HARQ-ACK reporting in physical uplink shared channel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HARQ-ACK-reporting-in-physical-uplink-control-channel"><span class="nav-number">6.2.2.</span> <span class="nav-text">HARQ-ACK reporting in physical uplink control channel</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HARQ-ACK-procedures-for-one-configured-serving-cell"><span class="nav-number">6.2.2.1.</span> <span class="nav-text">HARQ-ACK procedures for one configured serving cell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HARQ-ACK-procedures-for-more-than-one-configured-serving-cell"><span class="nav-number">6.2.2.2.</span> <span class="nav-text">HARQ-ACK procedures for more than one configured serving cell</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-reporting-SR"><span class="nav-number">6.3.</span> <span class="nav-text">UE procedure for reporting SR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-reporting-multiple-UCI-types"><span class="nav-number">6.4.</span> <span class="nav-text">UE procedure for reporting multiple UCI types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UCI-repetition-procedure"><span class="nav-number">6.5.</span> <span class="nav-text">UCI repetition procedure</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UE-procedure-for-receiving-control-information"><span class="nav-number">7.</span> <span class="nav-text">UE procedure for receiving control information</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-common-search-space"><span class="nav-number">7.1.</span> <span class="nav-text">UE procedure for determining physical downlink control channel assignment in common search space</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UE-procedure-for-determining-physical-downlink-control-channel-assignment-in-UE-specific-search-space"><span class="nav-number">7.2.</span> <span class="nav-text">UE procedure for determining physical downlink control channel assignment in UE-specific search space</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bandwidth-part-operation"><span class="nav-number">8.</span> <span class="nav-text">Bandwidth part operation</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configurations-and-assumptions-independent-of-physical-channels-or-signals"><span class="nav-number">9.</span> <span class="nav-text">Configurations and assumptions independent of physical channels or signals</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#相关链接"><span class="nav-number">10.</span> <span class="nav-text">相关链接</span></a></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-star"></i> </span><span class="author" itemprop="copyrightHolder">Marshall</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i> <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="site-pv"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script><script type="text/javascript">!function(){var t="cytaUfAfH",e="prod_d168db90253ab2bc78368034d167c214",n=window.innerWidth||document.documentElement.clientWidth;if(n<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+t+"&conf="+e+'"><\/script>');else{var a=function(t,e){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)};a("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:t,conf:e})})}}()</script><script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html><!-- rebuild by neat -->